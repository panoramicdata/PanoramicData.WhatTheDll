<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PanoramicData.WhatTheDll</title>
    <base href="/" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="PanoramicData.WhatTheDll.styles.css" rel="stylesheet" />
    <script>
        // Set theme based on user's system preference
        (function() {
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-bs-theme', prefersDark ? 'dark' : 'light');
            
            // Listen for system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                document.documentElement.setAttribute('data-bs-theme', e.matches ? 'dark' : 'light');
            });
        })();

        // File drop handling for Blazor InputFile
        window.initializeDropZone = function(dropZoneElement, inputElement) {
            // Prevent default drag behaviors on the entire document to stop browser from opening files
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.body.addEventListener(eventName, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });
            
            // Set up the drop zone to forward files to the input
            if (dropZoneElement && inputElement) {
                dropZoneElement.addEventListener('drop', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        // Create a new DataTransfer to set files on the input
                        const dataTransfer = new DataTransfer();
                        for (let i = 0; i < files.length; i++) {
                            dataTransfer.items.add(files[i]);
                        }
                        inputElement.files = dataTransfer.files;
                        
                        // Trigger the change event so Blazor picks it up
                        const event = new Event('change', { bubbles: true });
                        inputElement.dispatchEvent(event);
                    }
                }, false);
            }
        };

        window.triggerFileInput = function(inputElement) {
            if (inputElement) {
                inputElement.click();
            }
        };
    </script>
</head>

<body>
    <div id="app">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="https://unpkg.com/split.js/dist/split.min.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
        window.initializeSplit = function() {
            var treePanel = document.querySelector('.tree-panel');
            var detailsPanel = document.querySelector('.details-panel');
            if (treePanel && detailsPanel && !treePanel.dataset.splitInitialized) {
                Split(['.tree-panel', '.details-panel'], {
                    sizes: [35, 65],
                    minSize: [250, 300],
                    gutterSize: 6,
                    cursor: 'col-resize',
                    direction: 'horizontal'
                });
                treePanel.dataset.splitInitialized = 'true';
            }
        };
    </script>
</body>

</html>
